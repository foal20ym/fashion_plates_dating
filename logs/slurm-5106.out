now processing task id:: 5106 on worker2.slurm.hj.se
2025-05-16 08:44:08.481153: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1747385051.460020 1145475 gpu_device.cc:2018] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8098 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 1g.10gb, pci bus id: 0000:81:00.0, compute capability: 8.0
WARNING:tensorflow:AutoGraph could not transform <function train_and_evaluate.<locals>.<lambda> at 0x7f433f8ff5b0> and will run it as-is.
Cause: could not parse the source code of <function train_and_evaluate.<locals>.<lambda> at 0x7f433f8ff5b0>: found multiple definitions with identical signatures at the location. This error may be avoided by defining each lambda on a single line and with unique argument names. The matching definitions were:
Match 0:
lambda x, y: (x, y)

Match 1:
lambda x, y: y

To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING:tensorflow:AutoGraph could not transform <function train_and_evaluate.<locals>.<lambda> at 0x7f433f8ff370> and will run it as-is.
Cause: could not parse the source code of <function train_and_evaluate.<locals>.<lambda> at 0x7f433f8ff370>: found multiple definitions with identical signatures at the location. This error may be avoided by defining each lambda on a single line and with unique argument names. The matching definitions were:
Match 0:
lambda x, y: (x, y)

Match 1:
lambda x, y: y

To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING:tensorflow:AutoGraph could not transform <function train_and_evaluate.<locals>.<lambda> at 0x7f4330575ea0> and will run it as-is.
Cause: could not parse the source code of <function train_and_evaluate.<locals>.<lambda> at 0x7f4330575ea0>: found multiple definitions with identical signatures at the location. This error may be avoided by defining each lambda on a single line and with unique argument names. The matching definitions were:
Match 0:
lambda x, y: (x, y)

Match 1:
lambda x, y: y

To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING:tensorflow:AutoGraph could not transform <function train_and_evaluate.<locals>.<lambda> at 0x7f4330576170> and will run it as-is.
Cause: could not parse the source code of <function train_and_evaluate.<locals>.<lambda> at 0x7f4330576170>: found multiple definitions with identical signatures at the location. This error may be avoided by defining each lambda on a single line and with unique argument names. The matching definitions were:
Match 0:
lambda x, y: (x, y)

Match 1:
lambda x, y: y

To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2025-05-16 08:44:33.469548: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 1607 of 11303
2025-05-16 08:44:43.471222: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 3989 of 11303
2025-05-16 08:44:53.476349: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 6325 of 11303
2025-05-16 08:45:13.470202: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 10440 of 11303
2025-05-16 08:45:16.510148: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:483] Shuffle buffer filled.
2025-05-16 08:45:26.556877: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 1863 of 11303
2025-05-16 08:45:46.610059: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 6154 of 11303
2025-05-16 08:45:56.690618: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 7987 of 11303
2025-05-16 08:46:11.941491: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:483] Shuffle buffer filled.
2025-05-16 08:46:11.995218: I external/local_xla/xla/service/service.cc:152] XLA service 0x7f399c002670 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2025-05-16 08:46:11.995278: I external/local_xla/xla/service/service.cc:160]   StreamExecutor device (0): NVIDIA A100 80GB PCIe MIG 1g.10gb, Compute Capability 8.0
2025-05-16 08:46:12.204599: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
I0000 00:00:1747385174.040319 1146118 cuda_dnn.cc:529] Loaded cuDNN version 90300
2025-05-16 08:46:19.912803: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_9379', 4 bytes spill stores, 4 bytes spill loads

2025-05-16 08:46:20.571144: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_8689', 88 bytes spill stores, 88 bytes spill loads

2025-05-16 08:46:22.962279: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_8689', 16 bytes spill stores, 16 bytes spill loads

2025-05-16 08:46:23.005141: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_3', 12 bytes spill stores, 12 bytes spill loads

I0000 00:00:1747385196.992592 1146118 device_compiler.h:196] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2025-05-16 08:47:58.100017: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_8689', 88 bytes spill stores, 88 bytes spill loads

2025-05-16 08:47:59.368586: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_9379', 4 bytes spill stores, 4 bytes spill loads

2025-05-16 08:47:59.691873: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_3', 12 bytes spill stores, 12 bytes spill loads

2025-05-16 08:47:59.888350: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_8689', 16 bytes spill stores, 16 bytes spill loads

2025-05-16 08:48:21.586911: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_2485', 188 bytes spill stores, 188 bytes spill loads

2025-05-16 08:48:21.635588: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_1', 216 bytes spill stores, 216 bytes spill loads

2025-05-16 08:48:21.854118: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_1', 196 bytes spill stores, 196 bytes spill loads

2025-05-16 08:48:21.919809: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_2485', 220 bytes spill stores, 220 bytes spill loads

2025-05-16 08:49:01.783717: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 2135 of 11303
2025-05-16 08:49:21.896619: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 6222 of 11303
2025-05-16 08:49:32.088095: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 7986 of 11303
2025-05-16 08:49:48.101646: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:483] Shuffle buffer filled.
2025-05-16 08:49:58.107393: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 2233 of 11303
2025-05-16 08:50:08.112076: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 4444 of 11303
2025-05-16 08:50:18.197598: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 6374 of 11303
2025-05-16 08:50:38.173357: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 10227 of 11303
2025-05-16 08:50:42.972863: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:483] Shuffle buffer filled.
2025-05-16 08:53:32.205598: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
finished task with id:: 5106
