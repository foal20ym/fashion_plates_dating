now processing task id:: 5115 on worker7.slurm.hj.se
2025-05-16 09:24:13.825142: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1747387456.823088  816418 gpu_device.cc:2018] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8098 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 1g.10gb, pci bus id: 0000:81:00.0, compute capability: 8.0
WARNING:tensorflow:AutoGraph could not transform <function train_and_evaluate.<locals>.<lambda> at 0x7f0213603370> and will run it as-is.
Cause: could not parse the source code of <function train_and_evaluate.<locals>.<lambda> at 0x7f0213603370>: found multiple definitions with identical signatures at the location. This error may be avoided by defining each lambda on a single line and with unique argument names. The matching definitions were:
Match 0:
lambda x, y: (x, y)

Match 1:
lambda x, y: y

To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING:tensorflow:AutoGraph could not transform <function train_and_evaluate.<locals>.<lambda> at 0x7f0200313a30> and will run it as-is.
Cause: could not parse the source code of <function train_and_evaluate.<locals>.<lambda> at 0x7f0200313a30>: found multiple definitions with identical signatures at the location. This error may be avoided by defining each lambda on a single line and with unique argument names. The matching definitions were:
Match 0:
lambda x, y: (x, y)

Match 1:
lambda x, y: y

To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING:tensorflow:AutoGraph could not transform <function train_and_evaluate.<locals>.<lambda> at 0x7f019476c1f0> and will run it as-is.
Cause: could not parse the source code of <function train_and_evaluate.<locals>.<lambda> at 0x7f019476c1f0>: found multiple definitions with identical signatures at the location. This error may be avoided by defining each lambda on a single line and with unique argument names. The matching definitions were:
Match 0:
lambda x, y: (x, y)

Match 1:
lambda x, y: y

To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING:tensorflow:AutoGraph could not transform <function train_and_evaluate.<locals>.<lambda> at 0x7f02002b36d0> and will run it as-is.
Cause: could not parse the source code of <function train_and_evaluate.<locals>.<lambda> at 0x7f02002b36d0>: found multiple definitions with identical signatures at the location. This error may be avoided by defining each lambda on a single line and with unique argument names. The matching definitions were:
Match 0:
lambda x, y: (x, y)

Match 1:
lambda x, y: y

To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2025-05-16 09:24:39.077504: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 1913 of 11303
2025-05-16 09:24:58.915132: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 6816 of 11303
2025-05-16 09:25:09.188835: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 8965 of 11303
2025-05-16 09:25:18.626553: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:483] Shuffle buffer filled.
2025-05-16 09:25:28.641146: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 2191 of 11303
2025-05-16 09:25:38.644096: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 4516 of 11303
2025-05-16 09:25:58.810339: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 9036 of 11303
2025-05-16 09:26:07.554253: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:483] Shuffle buffer filled.
2025-05-16 09:26:07.624972: I external/local_xla/xla/service/service.cc:152] XLA service 0x7ef8780036b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2025-05-16 09:26:07.625048: I external/local_xla/xla/service/service.cc:160]   StreamExecutor device (0): NVIDIA A100 80GB PCIe MIG 1g.10gb, Compute Capability 8.0
2025-05-16 09:26:07.850517: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
I0000 00:00:1747387569.749530  817060 cuda_dnn.cc:529] Loaded cuDNN version 90300
2025-05-16 09:26:14.958908: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_8689', 88 bytes spill stores, 88 bytes spill loads

2025-05-16 09:26:17.178496: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_9379', 4 bytes spill stores, 4 bytes spill loads

2025-05-16 09:26:18.083306: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_8689', 16 bytes spill stores, 16 bytes spill loads

2025-05-16 09:26:18.111833: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_3', 12 bytes spill stores, 12 bytes spill loads

I0000 00:00:1747387592.966760  817060 device_compiler.h:196] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2025-05-16 09:27:54.303358: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_3', 12 bytes spill stores, 12 bytes spill loads

2025-05-16 09:27:54.995334: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_9379', 4 bytes spill stores, 4 bytes spill loads

2025-05-16 09:27:55.383152: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_8689', 88 bytes spill stores, 88 bytes spill loads

2025-05-16 09:27:56.486525: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_8689', 16 bytes spill stores, 16 bytes spill loads

2025-05-16 09:28:19.394350: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_2485', 188 bytes spill stores, 188 bytes spill loads

2025-05-16 09:28:19.404467: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_1', 196 bytes spill stores, 196 bytes spill loads

2025-05-16 09:28:19.481653: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_1', 216 bytes spill stores, 216 bytes spill loads

2025-05-16 09:28:19.485048: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_2485', 220 bytes spill stores, 220 bytes spill loads

2025-05-16 09:28:53.077842: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 2241 of 11303
2025-05-16 09:29:13.103057: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 6944 of 11303
2025-05-16 09:29:33.033628: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 11132 of 11303
2025-05-16 09:29:33.045736: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:483] Shuffle buffer filled.
2025-05-16 09:29:43.051916: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 2022 of 11303
2025-05-16 09:29:53.052219: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 4219 of 11303
2025-05-16 09:30:03.084085: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 6320 of 11303
2025-05-16 09:30:23.288222: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 10228 of 11303
2025-05-16 09:30:26.710084: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:483] Shuffle buffer filled.
2025-05-16 09:33:08.311393: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
finished task with id:: 5115
