now processing task id:: 5087 on worker2.slurm.hj.se
2025-05-16 07:33:14.208886: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1747380797.640790 1138170 gpu_device.cc:2018] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 8098 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe MIG 1g.10gb, pci bus id: 0000:81:00.0, compute capability: 8.0
WARNING:tensorflow:AutoGraph could not transform <function train_and_evaluate.<locals>.<lambda> at 0x7f683ed13490> and will run it as-is.
Cause: could not parse the source code of <function train_and_evaluate.<locals>.<lambda> at 0x7f683ed13490>: found multiple definitions with identical signatures at the location. This error may be avoided by defining each lambda on a single line and with unique argument names. The matching definitions were:
Match 0:
lambda x, y: (x, y)

Match 1:
lambda x, y: y

To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING:tensorflow:AutoGraph could not transform <function train_and_evaluate.<locals>.<lambda> at 0x7f683ed13250> and will run it as-is.
Cause: could not parse the source code of <function train_and_evaluate.<locals>.<lambda> at 0x7f683ed13250>: found multiple definitions with identical signatures at the location. This error may be avoided by defining each lambda on a single line and with unique argument names. The matching definitions were:
Match 0:
lambda x, y: (x, y)

Match 1:
lambda x, y: y

To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING:tensorflow:AutoGraph could not transform <function train_and_evaluate.<locals>.<lambda> at 0x7f68300f5c60> and will run it as-is.
Cause: could not parse the source code of <function train_and_evaluate.<locals>.<lambda> at 0x7f68300f5c60>: found multiple definitions with identical signatures at the location. This error may be avoided by defining each lambda on a single line and with unique argument names. The matching definitions were:
Match 0:
lambda x, y: (x, y)

Match 1:
lambda x, y: y

To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
WARNING:tensorflow:AutoGraph could not transform <function train_and_evaluate.<locals>.<lambda> at 0x7f68300f5f30> and will run it as-is.
Cause: could not parse the source code of <function train_and_evaluate.<locals>.<lambda> at 0x7f68300f5f30>: found multiple definitions with identical signatures at the location. This error may be avoided by defining each lambda on a single line and with unique argument names. The matching definitions were:
Match 0:
lambda x, y: (x, y)

Match 1:
lambda x, y: y

To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert
2025-05-16 07:33:40.387903: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 1790 of 11303
2025-05-16 07:33:50.587814: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 3925 of 11303
2025-05-16 07:34:10.466054: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 7652 of 11303
2025-05-16 07:34:28.902432: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:483] Shuffle buffer filled.
2025-05-16 07:34:38.907549: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 1819 of 11303
2025-05-16 07:34:48.916897: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 3790 of 11303
2025-05-16 07:34:58.985127: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 5667 of 11303
2025-05-16 07:35:18.981042: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 9001 of 11303
2025-05-16 07:35:29.395205: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 11071 of 11303
2025-05-16 07:35:29.823597: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:483] Shuffle buffer filled.
2025-05-16 07:35:29.864551: I external/local_xla/xla/service/service.cc:152] XLA service 0x7f5e88004dc0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2025-05-16 07:35:29.864618: I external/local_xla/xla/service/service.cc:160]   StreamExecutor device (0): NVIDIA A100 80GB PCIe MIG 1g.10gb, Compute Capability 8.0
2025-05-16 07:35:30.119886: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
I0000 00:00:1747380931.892411 1138816 cuda_dnn.cc:529] Loaded cuDNN version 90300
2025-05-16 07:35:41.784574: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_9379', 4 bytes spill stores, 4 bytes spill loads

2025-05-16 07:35:42.747525: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_8689', 88 bytes spill stores, 88 bytes spill loads

2025-05-16 07:35:42.767184: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_8689', 16 bytes spill stores, 16 bytes spill loads

2025-05-16 07:35:42.825449: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_3', 12 bytes spill stores, 12 bytes spill loads

I0000 00:00:1747380957.546765 1138816 device_compiler.h:196] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2025-05-16 07:37:22.237136: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_8689', 88 bytes spill stores, 88 bytes spill loads

2025-05-16 07:37:23.100112: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_9379', 4 bytes spill stores, 4 bytes spill loads

2025-05-16 07:37:24.558357: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_3', 12 bytes spill stores, 12 bytes spill loads

2025-05-16 07:37:24.561387: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_8689', 16 bytes spill stores, 16 bytes spill loads

2025-05-16 07:37:47.735905: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_2485', 188 bytes spill stores, 188 bytes spill loads

2025-05-16 07:37:47.768020: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_1', 196 bytes spill stores, 196 bytes spill loads

2025-05-16 07:37:47.833424: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_2485', 220 bytes spill stores, 220 bytes spill loads

2025-05-16 07:37:47.865282: I external/local_xla/xla/stream_executor/cuda/subprocess_compilation.cc:346] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_1', 216 bytes spill stores, 216 bytes spill loads

2025-05-16 07:38:30.204604: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 1675 of 11303
2025-05-16 07:38:50.387380: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 5413 of 11303
2025-05-16 07:39:10.484722: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:2: Filling up shuffle buffer (this may take a while): 9589 of 11303
2025-05-16 07:39:19.042230: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:483] Shuffle buffer filled.
2025-05-16 07:39:29.094525: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 1997 of 11303
2025-05-16 07:39:49.082446: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 5561 of 11303
2025-05-16 07:39:59.095268: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 7548 of 11303
2025-05-16 07:40:19.212434: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:453] ShuffleDatasetV3:6: Filling up shuffle buffer (this may take a while): 10773 of 11303
2025-05-16 07:40:20.716013: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:483] Shuffle buffer filled.
2025-05-16 07:42:25.151868: W tensorflow/core/framework/op_kernel.cc:1856] OP_REQUIRES failed at xla_ops.cc:590 : INVALID_ARGUMENT: Detected unsupported operations when trying to compile graph __inference_one_step_on_data_224413[] on XLA_GPU_JIT: _Arg (No registered '_Arg' OpKernel for XLA_GPU_JIT devices compatible with node {{node data_3}}
	 (OpKernel was found, but attributes didn't match) Requested Attributes: T=DT_STRING, _output_shapes=[[8]], _user_specified_name="data", index=3){{node data_3}}
The op is created at: 
File "fashion_plates_dating/fashion.py", line 1184, in <module>
File "fashion_plates_dating/fashion.py", line 1162, in main
File "fashion_plates_dating/fashion.py", line 647, in train_and_evaluate
File "micromamba/envs/tf_new/lib/python3.10/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "micromamba/envs/tf_new/lib/python3.10/site-packages/keras/src/backend/tensorflow/trainer.py", line 560, in predict
File "micromamba/envs/tf_new/lib/python3.10/site-packages/keras/src/backend/tensorflow/trainer.py", line 259, in one_step_on_data_distributed
File "micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/polymorphism/function_type.py", line 356, in placeholder_arguments
File "micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/trace_type/default_types.py", line 250, in placeholder_value
File "micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/trace_type/default_types.py", line 251, in <listcomp>
	tf2xla conversion failed while converting __inference_one_step_on_data_224413[]. Run with TF_DUMP_GRAPH_PREFIX=/path/to/dump/dir and --vmodule=xla_compiler=2 to obtain a dump of the compiled functions.
2025-05-16 07:42:25.151995: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: INVALID_ARGUMENT: Detected unsupported operations when trying to compile graph __inference_one_step_on_data_224413[] on XLA_GPU_JIT: _Arg (No registered '_Arg' OpKernel for XLA_GPU_JIT devices compatible with node {{node data_3}}
	 (OpKernel was found, but attributes didn't match) Requested Attributes: T=DT_STRING, _output_shapes=[[8]], _user_specified_name="data", index=3){{node data_3}}
The op is created at: 
File "fashion_plates_dating/fashion.py", line 1184, in <module>
File "fashion_plates_dating/fashion.py", line 1162, in main
File "fashion_plates_dating/fashion.py", line 647, in train_and_evaluate
File "micromamba/envs/tf_new/lib/python3.10/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "micromamba/envs/tf_new/lib/python3.10/site-packages/keras/src/backend/tensorflow/trainer.py", line 560, in predict
File "micromamba/envs/tf_new/lib/python3.10/site-packages/keras/src/backend/tensorflow/trainer.py", line 259, in one_step_on_data_distributed
File "micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/polymorphism/function_type.py", line 356, in placeholder_arguments
File "micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/trace_type/default_types.py", line 250, in placeholder_value
File "micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/trace_type/default_types.py", line 251, in <listcomp>
	tf2xla conversion failed while converting __inference_one_step_on_data_224413[]. Run with TF_DUMP_GRAPH_PREFIX=/path/to/dump/dir and --vmodule=xla_compiler=2 to obtain a dump of the compiled functions.
	 [[StatefulPartitionedCall]]
Traceback (most recent call last):
  File "/home/anjo19go/fashion_plates_dating/fashion.py", line 1184, in <module>
    #         df = pd.read_csv(file)
  File "/home/anjo19go/fashion_plates_dating/fashion.py", line 1162, in main
    class_to_idx = None
  File "/home/anjo19go/fashion_plates_dating/fashion.py", line 647, in train_and_evaluate
    results = model.evaluate(val_ds_batched, verbose=0)
  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/python/eager/execute.py", line 53, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node data_3 defined at (most recent call last):
  File "/home/anjo19go/fashion_plates_dating/fashion.py", line 1184, in <module>

  File "/home/anjo19go/fashion_plates_dating/fashion.py", line 1162, in main

  File "/home/anjo19go/fashion_plates_dating/fashion.py", line 647, in train_and_evaluate

  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler

  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/keras/src/backend/tensorflow/trainer.py", line 560, in predict

  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/polymorphism/function_type.py", line 356, in placeholder_arguments

  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/trace_type/default_types.py", line 346, in placeholder_value

  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/trace_type/default_types.py", line 250, in placeholder_value

  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/trace_type/default_types.py", line 251, in <listcomp>

  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/trace_type/default_types.py", line 250, in placeholder_value

  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/trace_type/default_types.py", line 251, in <listcomp>

Detected at node data_3 defined at (most recent call last):
  File "/home/anjo19go/fashion_plates_dating/fashion.py", line 1184, in <module>

  File "/home/anjo19go/fashion_plates_dating/fashion.py", line 1162, in main

  File "/home/anjo19go/fashion_plates_dating/fashion.py", line 647, in train_and_evaluate

  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler

  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/keras/src/backend/tensorflow/trainer.py", line 560, in predict

  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/polymorphism/function_type.py", line 356, in placeholder_arguments

  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/trace_type/default_types.py", line 346, in placeholder_value

  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/trace_type/default_types.py", line 250, in placeholder_value

  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/trace_type/default_types.py", line 251, in <listcomp>

  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/trace_type/default_types.py", line 250, in placeholder_value

  File "/home/anjo19go/micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/trace_type/default_types.py", line 251, in <listcomp>

Detected unsupported operations when trying to compile graph __inference_one_step_on_data_224413[] on XLA_GPU_JIT: _Arg (No registered '_Arg' OpKernel for XLA_GPU_JIT devices compatible with node {{node data_3}}
	 (OpKernel was found, but attributes didn't match) Requested Attributes: T=DT_STRING, _output_shapes=[[8]], _user_specified_name="data", index=3){{node data_3}}
The op is created at: 
File "fashion_plates_dating/fashion.py", line 1184, in <module>
File "fashion_plates_dating/fashion.py", line 1162, in main
File "fashion_plates_dating/fashion.py", line 647, in train_and_evaluate
File "micromamba/envs/tf_new/lib/python3.10/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler
File "micromamba/envs/tf_new/lib/python3.10/site-packages/keras/src/backend/tensorflow/trainer.py", line 560, in predict
File "micromamba/envs/tf_new/lib/python3.10/site-packages/keras/src/backend/tensorflow/trainer.py", line 259, in one_step_on_data_distributed
File "micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/polymorphism/function_type.py", line 356, in placeholder_arguments
File "micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/trace_type/default_types.py", line 250, in placeholder_value
File "micromamba/envs/tf_new/lib/python3.10/site-packages/tensorflow/core/function/trace_type/default_types.py", line 251, in <listcomp>
	tf2xla conversion failed while converting __inference_one_step_on_data_224413[]. Run with TF_DUMP_GRAPH_PREFIX=/path/to/dump/dir and --vmodule=xla_compiler=2 to obtain a dump of the compiled functions.
	 [[StatefulPartitionedCall]] [Op:__inference_one_step_on_data_distributed_225194]
finished task with id:: 5087
